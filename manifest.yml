---
applications:
  - name: protocap-api
    path: backend/deployment/
    buildpacks:
      - nodejs_buildpack
    memory: 256M
    routes:
      - route: >- 
          protocap-api.cfapps.eu20.hana.ondemand.com
    services:
      - protocap-xsuaa
      - protocap-destinations
      - protocap-op
      - protocap-sreg
    env:
      APPROUTER_NAME: protocap-approuter
      DESTINATION_NAME: protocap-dest

  - name: protocap-approuter
    path: approuter/
    routes:
      - route: protocap.cfapps.eu20.hana.ondemand.com
    memory: 128M
    buildpacks:
      - nodejs_buildpack
    root: "."
    env:
      TENANT_HOST_PATTERN: '^(.*)-protocap.cfapps.eu20.hana.ondemand.com'
      SESSION_TIMEOUT: 120
      destinations: >-
        [{"name":"backend","url":"https://protocap-api.cfapps.eu20.hana.ondemand.com","forwardAuthToken":true,"timeout":120000},
         {"name":"frontend","url":"https://protocap.cfapps.eu20.hana.ondemand.com","forwardAuthToken":true,"timeout":120000}]
      httpHeaders: >-
        [{"X-Content-Type-Options":"nosniff"},
         {"Content-Security-Policy":"script-src 'self' 'unsafe-eval' https://sapui5.hana.ondemand.com/resources/;style-src 'self' 'unsafe-inline' https://sapui5.hana.ondemand.com/resources/;font-src 'self' https://sapui5.hana.ondemand.com/resources/;img-src 'self' https://sapui5.hana.ondemand.com/resources/;frame-src https://sapui5.hana.ondemand.com/resources/;worker-src https://sapui5.hana.ondemand.com/resources/;connect-src 'self' https://sapui5.hana.ondemand.com/resources/"}]
    services:
      - protocap-xsuaa